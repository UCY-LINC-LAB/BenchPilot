<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Extending BenchPilot #  This section describes all of the steps you need to take in order to extend BenchPilot for supporting more workloads!
Dockerize Workload #  The first step to extend BenchPiot, is to create the necessary docker images. In general BenchPilot utilizes the idea of having a controller node (which BenchPilot&rsquo;s client and other core services will reside on), and the workers, which will be the system under test.">
<meta name="theme-color" content="#FFFFFF">
<meta name="color-scheme" content="light dark"><meta property="og:title" content="Exteding BenchPilot" />
<meta property="og:description" content="Extending BenchPilot #  This section describes all of the steps you need to take in order to extend BenchPilot for supporting more workloads!
Dockerize Workload #  The first step to extend BenchPiot, is to create the necessary docker images. In general BenchPilot utilizes the idea of having a controller node (which BenchPilot&rsquo;s client and other core services will reside on), and the workers, which will be the system under test." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ucy-linc-lab.github.io/BenchPilot/docs/exteding-framework/" /><meta property="article:section" content="docs" />



<title>Exteding BenchPilot | BenchPilot</title>
<link rel="manifest" href="/BenchPilot/manifest.json">
<link rel="icon" href="/BenchPilot/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/BenchPilot/book.min.fb69d0e92fcd17fb4042199e803e6bfa0ec2c53ccb74bf57e949532662854dff.css" integrity="sha256-&#43;2nQ6S/NF/tAQhmegD5r&#43;g7CxTzLdL9X6UlTJmKFTf8=" crossorigin="anonymous">
  <script defer src="/BenchPilot/flexsearch.min.js"></script>
  <script defer src="/BenchPilot/en.search.min.fd8f4b8988d948a37a24c55e5b4dde32873008b060974b87c0ef24cd0f14c52b.js" integrity="sha256-/Y9LiYjZSKN6JMVeW03eMocwCLBgl0uHwO8kzQ8UxSs=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/BenchPilot/"><img src="/BenchPilot/images/plane.png" alt="Logo" /><span>BenchPilot</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>












  



  
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/BenchPilot/docs/getting-started/" class="">Getting Started</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/BenchPilot/docs/installation/" class="">Installation</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/BenchPilot/docs/experiments/" class="">Experiments</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/BenchPilot/docs/workloads/" class="">Workloads</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/BenchPilot/docs/monitoring/" class="">Monitoring</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/BenchPilot/docs/experiment-analysis/" class="">Post-Experiment Analysis</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/BenchPilot/docs/exteding-framework/" class="active">Exteding BenchPilot</a>
  

        </li>
      
    
  </ul>











  
<ul>
  
  <li>
    <a href="http://linc.ucy.ac.cy" target="_blank" rel="noopener">
        About Us
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/BenchPilot/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Exteding BenchPilot</strong>

  <label for="toc-control">
    
    <img src="/BenchPilot/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#dockerize-workload">Dockerize Workload</a></li>
    <li><a href="#adding-new-services">Adding New Services</a></li>
    <li><a href="#adding-new-workload">Adding New Workload</a>
      <ul>
        <li><a href="#adding-a-new-sdpe-workload">Adding a new SDPE Workload</a></li>
        <li><a href="#creating-a-workload-setup">Creating a workload Setup</a></li>
        <li><a href="#adding-the-workload-into-the-workload-factory">Adding the workload into the workload factory</a></li>
      </ul>
    </li>
    <li><a href="#creating-a-new-agent-for-submitting-the-job">Creating a new agent for submitting the job</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="strong-stylecolor-40897bextending-benchpilotstrong">
  <strong style="color: #40897B">Extending BenchPilot</strong>
  <a class="anchor" href="#strong-stylecolor-40897bextending-benchpilotstrong">#</a>
</h1>
<p>This section describes all of the steps you need to take in order to extend BenchPilot for supporting more workloads!</p>
<h2 id="dockerize-workload">
  Dockerize Workload
  <a class="anchor" href="#dockerize-workload">#</a>
</h2>
<p>The first step to extend BenchPiot, is to create the necessary docker images. In general BenchPilot utilizes the idea of having a controller node (which BenchPilot&rsquo;s client and other core services will reside on), and the workers, which will be the system under test. Having this scheme in mind, you need to dockerize your workload, and to divide it into images that will reside on your controller node, and another image which will be deployed on the workers.</p>
<h2 id="adding-new-services">
  Adding New Services
  <a class="anchor" href="#adding-new-services">#</a>
</h2>
<p>After creating the latter images, you should add under the /BenchPilotSDK/services the new service. That class should derive its properties from the BenchPilot&rsquo;s abstract service object. Keep in mind that for every docker image you created for your workload, you should declare it as a different service.</p>
<p>For each service it is important to declare the following:</p>
<ul>
<li><i>docker image</i>, either an already existing one, or you have to create it on your own</li>
<li><i>hostname</i>, we use the same one as the service name usually</li>
<li><i>image tag</i></li>
<li><i>image arm tag</i>, if one exists</li>
<li><i>ports</i>, needed ports</li>
<li><i>environment</i>, needed environment variables / configurations</li>
<li><i>service log</i>, the log that the service prints when is up and running</li>
<li><i>Depends On</i>, here you should add the service name that it&rsquo;s important to start before the one you just created</li>
<li><i>Command</i>, in case if it needs to execute a specific command when the service starts</li>
<li><i>Proxy</i>, a simple &ldquo;True&rdquo; / &ldquo;False&rdquo; definition, whether it will reside on a device that passes through proxy</li>
<li><i>needs_placement</i>, again, &ldquo;True&rdquo; if it should reside on a worker, &ldquo;False&rdquo; if it&rsquo;s a core service and will reside on the manager node</li>
</ul>
<p>Below you can see a service example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> BenchPilotSDK.services.service <span style="color:#f92672">import</span> Service
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Redis</span>(Service):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    This class represents the redis docker service
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>        Service<span style="color:#f92672">.</span>__init__(self)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>hostname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;redis&#34;</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>image <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;bitnami/redis&#34;</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>image_tag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;6.0.10&#34;</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>image_arm_tag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;not supported&#34;</span> <span style="color:#75715e"># in case of not supporting arm images</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>ports <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;6379:6379&#34;</span>]
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>environment <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;ALLOW_EMPTY_PASSWORD=yes&#34;</span>]
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>service_log <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Ready to accept connections&#34;</span>
</span></span></code></pre></div><p>** Before adding new services, check first if it already exists.</p>
<h2 id="adding-new-workload">
  Adding New Workload
  <a class="anchor" href="#adding-new-workload">#</a>
</h2>
<p>After adding all of your workload&rsquo;s services, you should create a new workload class as well, under the /BenchPilotSDK/workloads. This particular class will inherit its behavior from the &ldquo;workload&rdquo; class. In that class you should add in the &ldquo;services list&rdquo; all the services you need.</p>
<p>In the following block you can find a Workload example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> abc <span style="color:#f92672">import</span> ABC
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> BenchPilotSDK.services.sdpe.engines <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> BenchPilotSDK.services.sdpe.engine <span style="color:#f92672">import</span> Engine
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> BenchPilotSDK.workloads.workload <span style="color:#f92672">import</span> Workload
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SDPEWorkload</span>(Workload, ABC):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    This class extends workload and adds the assign engine method in order to be able to assign
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    a specific streaming distributed processing engine
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    engine: Engine
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, workload_yaml, workload_name: str):
</span></span><span style="display:flex;"><span>        super()<span style="color:#f92672">.</span>__init__(workload_yaml)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>workload_setup<span style="color:#f92672">.</span>check_required_parameters(<span style="color:#e6db74">&#39;workload&#39;</span>, [<span style="color:#e6db74">&#34;engine&#34;</span>], workload_yaml)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>workload_setup<span style="color:#f92672">.</span>check_required_parameters(<span style="color:#e6db74">&#39;engine&#39;</span>, [<span style="color:#e6db74">&#34;name&#34;</span>], workload_yaml[<span style="color:#e6db74">&#34;engine&#34;</span>])
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assign_engine(workload_yaml[<span style="color:#e6db74">&#34;engine&#34;</span>][<span style="color:#e6db74">&#34;name&#34;</span>], workload_name)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>services<span style="color:#f92672">.</span>append(self<span style="color:#f92672">.</span>engine)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># this method is for generalizing the term &#34;Engine&#34;, hence the Engine is a generalized service that can be either Storm, Flink or Spark</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">assign_engine</span>(self, engine: str, workload_name: str):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> engine <span style="color:#f92672">is</span> <span style="color:#66d9ef">None</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;spark&#34;</span> <span style="color:#f92672">in</span> engine<span style="color:#f92672">.</span>lower():
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>engine <span style="color:#f92672">=</span> Spark(len(self<span style="color:#f92672">.</span>nodes), self<span style="color:#f92672">.</span>manager_ip, workload_name)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">elif</span> <span style="color:#e6db74">&#34;storm&#34;</span> <span style="color:#f92672">in</span> engine<span style="color:#f92672">.</span>lower():
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>engine <span style="color:#f92672">=</span> Storm(len(self<span style="color:#f92672">.</span>nodes), self<span style="color:#f92672">.</span>manager_ip, workload_name)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">elif</span> <span style="color:#e6db74">&#34;flink&#34;</span> <span style="color:#f92672">in</span> engine<span style="color:#f92672">.</span>lower():
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>engine <span style="color:#f92672">=</span> Flink(len(self<span style="color:#f92672">.</span>nodes), self<span style="color:#f92672">.</span>manager_ip, workload_name)
</span></span></code></pre></div><h3 id="adding-a-new-sdpe-workload">
  Adding a new SDPE Workload
  <a class="anchor" href="#adding-a-new-sdpe-workload">#</a>
</h3>
<p>In case of adding a new Streaming Distributed - based workload you don&rsquo;t need to add the engines, you only need to inherit from the <i>SDPEWorkload</i> class, and add the rest of the services, like the example below:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> abc <span style="color:#f92672">import</span> ABC
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> BenchPilotSDK.workloads.sdpeWorkload <span style="color:#f92672">import</span> SDPEWorkload
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> BenchPilotSDK.services.kafka <span style="color:#f92672">import</span> Kafka
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> BenchPilotSDK.services.redis <span style="color:#f92672">import</span> Redis
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> BenchPilotSDK.services.zookeeper <span style="color:#f92672">import</span> Zookeeper
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> BenchPilotSDK.workloads.setup.yahooWorkloadSetup <span style="color:#f92672">import</span> YahooWorkloadSetup
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Inherits from the SDPEWorkload class that already exists</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Yahoo</span>(SDPEWorkload, ABC):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    This class represents Yahoo Streaming Benchmark, it holds all of the extra needed services.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    - by extra we mean the services that are not DSPEs
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, workload_yaml):
</span></span><span style="display:flex;"><span>        super()<span style="color:#f92672">.</span>__init__(workload_yaml, <span style="color:#e6db74">&#34;marketing-campaign&#34;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>services<span style="color:#f92672">.</span>append(Zookeeper())
</span></span><span style="display:flex;"><span>        kafka <span style="color:#f92672">=</span> Kafka(len(self<span style="color:#f92672">.</span>nodes), self<span style="color:#f92672">.</span>manager_ip)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>services<span style="color:#f92672">.</span>append(kafka)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># defines which services would need to restart when a trials is over</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>restarting_services<span style="color:#f92672">.</span>append(kafka)
</span></span><span style="display:flex;"><span>        redis <span style="color:#f92672">=</span> Redis()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>services<span style="color:#f92672">.</span>append(redis)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>restarting_services<span style="color:#f92672">.</span>append(redis)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Assigns a workload setup</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>workload_setup <span style="color:#f92672">=</span> YahooWorkloadSetup(workload_yaml)
</span></span></code></pre></div><h3 id="creating-a-workload-setup">
  Creating a workload Setup
  <a class="anchor" href="#creating-a-workload-setup">#</a>
</h3>
<p>Under the /workloads we also included a setup package. In the setup package, you can add a new setup class thay you <strong>may</strong> need for configuring your workload. Your class should inherit and override the following class:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> abc <span style="color:#f92672">import</span> abstractmethod
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> BenchPilotSDK.utils.exceptions <span style="color:#f92672">import</span> MissingBenchExperimentAttributeException
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">WorkloadSetup</span>(object):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    The workloadSetup is responsible to set up the needed configuration files of a workload
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    cluster_dockerfile_path: str <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>environ[<span style="color:#e6db74">&#34;BENCHPILOT_PATH&#34;</span>]
</span></span><span style="display:flex;"><span>    workload_client_path: str <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>environ[<span style="color:#e6db74">&#34;BENCHPILOT_PATH&#34;</span>] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;dockerized-benchmarks/workload-client/&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, workload_yaml <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>workload_yaml <span style="color:#f92672">=</span> workload_yaml
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@abstractmethod</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">setup</span>(self, parameters <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>update_workload_configuration(parameters)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@abstractmethod</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">update_workload_configuration</span>(self, parameters):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># TODO override depending on the workload when rebuilding image</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@staticmethod</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check_required_parameters</span>(main_attribute, required_attributes, yaml):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> att <span style="color:#f92672">in</span> required_attributes:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> att <span style="color:#f92672">in</span> yaml:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">raise</span> MissingBenchExperimentAttributeException(main_attribute <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&gt; &#34;</span> <span style="color:#f92672">+</span> att)
</span></span></code></pre></div><p>In case of not needing a setup, you can just ignore this step.</p>
<h3 id="adding-the-workload-into-the-workload-factory">
  Adding the workload into the workload factory
  <a class="anchor" href="#adding-the-workload-into-the-workload-factory">#</a>
</h3>
<p>After adding the new workload, you should add a new &ldquo;if&rdquo; statement in the workload factory. This factory is applying the factory design pattern, and was added in order to generalize the &ldquo;workload&rdquo; object without needing to know with which object we are dealing with.</p>
<p>Below you can find the code from the <i>/BenchPilotSDK/workloads/WorkloadFactory.py</i>, where you need to replace in the last lines your new workload&rsquo;s name:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> BenchPilotSDK.workloads <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> BenchPilotSDK.workloads.setup.workloadSetup <span style="color:#f92672">import</span> WorkloadSetup
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">WorkloadFactory</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    This class works as a workload factory.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    workload: Workload
</span></span><span style="display:flex;"><span>    workloadSetup: WorkloadSetup
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, workload_yaml):
</span></span><span style="display:flex;"><span>        workloadSetup <span style="color:#f92672">=</span> WorkloadSetup()
</span></span><span style="display:flex;"><span>        workloadSetup<span style="color:#f92672">.</span>check_required_parameters(<span style="color:#e6db74">&#39;workload&#39;</span>, [<span style="color:#e6db74">&#34;name&#34;</span>], workload_yaml)
</span></span><span style="display:flex;"><span>        workload_name <span style="color:#f92672">=</span> workload_yaml[<span style="color:#e6db74">&#34;name&#34;</span>]<span style="color:#f92672">.</span>lower()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;yahoo&#34;</span> <span style="color:#f92672">in</span> workload_name <span style="color:#f92672">or</span> <span style="color:#e6db74">&#34;marketing-campaign&#34;</span> <span style="color:#f92672">in</span> workload_name:
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>workload <span style="color:#f92672">=</span> Yahoo(workload_yaml)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># replace the following lines with your new workload name</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> <span style="color:#e6db74">&#34;your-new-workload-name&#34;</span> <span style="color:#f92672">in</span> workload_name: 
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>workload <span style="color:#f92672">=</span> YourNewWorkloadName(workload_yaml)
</span></span></code></pre></div><h2 id="creating-a-new-agent-for-submitting-the-job">
  Creating a new agent for submitting the job
  <a class="anchor" href="#creating-a-new-agent-for-submitting-the-job">#</a>
</h2>
<p>This part may be the trickiest one. You need to create a new agent. For the record, the agent is basically a Flask REST API which will get every now and again requests from BenchPilot to (i) <strong>start a new benchmark</strong>, (ii) <strong>check the benchmarking status</strong> (if it began, if it&rsquo;s running or if it has finished), and (iii) <strong>to force stop a running benchmark</strong>. So you need to implement these three functionalities in order for BenchPilot to work as expected.</p>
<p>This class exists under the following path: <i>dockerized-benchmarks/workload-client/src</i>.</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(n){const e=window.getSelection(),t=document.createRange();t.selectNodeContents(n),e.removeAllRanges(),e.addRange(t)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#dockerize-workload">Dockerize Workload</a></li>
    <li><a href="#adding-new-services">Adding New Services</a></li>
    <li><a href="#adding-new-workload">Adding New Workload</a>
      <ul>
        <li><a href="#adding-a-new-sdpe-workload">Adding a new SDPE Workload</a></li>
        <li><a href="#creating-a-workload-setup">Creating a workload Setup</a></li>
        <li><a href="#adding-the-workload-into-the-workload-factory">Adding the workload into the workload factory</a></li>
      </ul>
    </li>
    <li><a href="#creating-a-new-agent-for-submitting-the-job">Creating a new agent for submitting the job</a></li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












